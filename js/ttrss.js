var Login=Backbone.Model.extend({urlRoot:"api.php",parse:function(response){return response.content}});var login=new Login({op:"login"});var Category=Backbone.Model.extend({urlRoot:"api.php"});var categories=new Category({op:"getCategories"});var LoginView=Backbone.View.extend({template:_.template($("#login-view-tpl").html()),events:{submit:"send"},send:function(e){e.preventDefault();var form=$("form",this.$el).get(0);login.set("user",form.login.value);login.set("password",form.password.value);login.fetch({data:JSON.stringify(login.attributes),type:"POST",contentType:"application/json"}).then(function(){console.log(login.get("session_id"))});return false},render:function(){this.$el.html(this.template(this.model.toJSON()));return this}});var CategoriesView=Backbone.View.extend({template:_.template('<form class="form-signin">'+'<h2 class="form-signin-heading">Please sign in</h2>'+'<input type="text" name="login" class="input-block-level" placeholder="Email address">'+'<input type="password" name="password" class="input-block-level" placeholder="Password">'+'<button class="btn btn-large btn-primary" type="submit">Sign in</button>'+"</form>"),events:{submit:"send"},send:function(e){e.preventDefault();var form=$("form",this.$el).get(0);login.set("user",form.login.value);login.set("password",form.password.value);login.fetch({data:JSON.stringify(login.attributes),type:"POST",contentType:"application/json"}).then(function(){console.log(login.get("session_id"))});return false},render:function(){this.$el.html(this.template(this.model.toJSON()));return this}});window.Categories=Backbone.Collection.extend({model:Category,url:"http://rss.billey.me/api"});window.TTRSS=new(Backbone.Router.extend({routes:{"":"index","cat/:id":"show"},initialize:function(){this.categories=new Categories;this.categoriesView=new CategoriesView({collection:this.categories});this.categoriesView.render()},index:function(){var loginView=new LoginView({model:login});loginView.render();$("#app").html(loginView.el)},start:function(){Backbone.history.start()},show:function(id){console.log(id)}}));$(function(){TTRSS.start()});